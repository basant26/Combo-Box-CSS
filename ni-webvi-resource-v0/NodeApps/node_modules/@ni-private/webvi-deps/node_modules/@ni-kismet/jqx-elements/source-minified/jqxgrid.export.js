"use strict";JQX.Utilities.Assign("Grid.Export",function(){function o(){babelHelpers.classCallCheck(this,o)}return babelHelpers.createClass(o,[{key:"exportData",value:function(o){var r=this,e=new JQX.Utilities.DataExporter({exportHeader:r.dataExport.header});if(e.expandChar=r.dataExport.expandChar,e.collapseChar=r.dataExport.collapseChar,e.pageOrientation=r.dataExport.pageOrientation,e.style=r.dataExport.style,e.filterBy=r.dataExport.filterBy,e.groupBy=r.dataExport.groupBy,e.header={columns:r.columns.toArray().slice(0),columngroups:r.columnGroups.slice(0)},!r.dataExport.style){var a=window.getComputedStyle(r),t=window.getComputedStyle(r.columns.length>0&&r.columns[0].element?r.columns[0].element:r.$.columnHeader),n=window.getComputedStyle(r.$.columnHeader);if(!(0===r.offsetWidth||0===r.offsetHeight)){for(var l=function(o){function r(o){return o=o.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),o?"#"+e(o[1])+e(o[2])+e(o[3]).toUpperCase():"#ffffff"}function e(o){return isNaN(o)?"00":i[(o-o%16)/16]+i[o%16]}var a=o.fontSize,t=o.borderRightColor,n=o.backgroundColor,l=o.color,i=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");return{borderColor:r(t),fontSize:a,fontFamily:"Helvetica",color:r(l),backgroundColor:r(n)}},i=l(a),d=l(t),c=l(n),p={height:r.$.columnHeader.offsetHeight+"px",border:"1px solid "+i.borderColor,fontFamily:c.fontFamily,fontSize:c.fontSize,color:c.color,backgroundColor:d.backgroundColor,fontWeight:"400"},u={border:"1px solid "+i.borderColor,fontFamily:i.fontFamily,fontSize:i.fontSize},s={height:r.rowMinHeight+"px"},f=0;f<r.columns.length;f++){var g=r.columns[f];if(g.allowExport&&g.visible){p[g.dataField]={textAlign:g.align,width:g.computedWidth+"px",format:g.cellsFormat||""};var h=g.cellsFormat||"";"date"===g.dataType?h="d":"dateTime"===g.dataType?h="D":"time"===g.dataType&&(h="t");var m={textAlign:g.cellsAlign,format:h};if(u[g.dataField]=m,r.dataExport.view&&-1!==["html","jpeg","pdf","png"].indexOf(o)&&(g.template||g.formatFunction))for(var y=0;y<r.rows.length;y++){var x=r.rows[y]["column_"+g.dataField];if(x){var C={};C.border=x.borderColor,C.background=x.background,C.color=x.color,m[y]=C}}}}r.appearance.alternationCount>0&&(s.alternationCount=r.appearance.alternationCount,s.alternationStart=r.appearance.alternationStart,s.alternationEnd=r.appearance.alternationEnd,s.alternationIndex0Color=i.color,s.alternationIndex0BackgroundColor=i.backgroundColor,s.alternationIndex1Color=i.color,s.alternationIndex1BackgroundColor="#F5F5F5"),e.style={border:"1px solid "+i.borderColor,borderCollapse:"collapse",header:p,columns:u,rows:s}}}var b=!r.rowHierarchy||r.grouping.enabled?r.rows.toArray():r.rowHierarchy,w=[];if(r.dataExport.view)r._recyclingRows.forEach(function(o){return w.push(o.data)});else{for(var v=0;v<b.length;v++){var E=b[v];!E.visible||!1===E.filtered&&void 0!==E.filtered||w.push(E.data)}b===r.rowHierarchy&&(w=r.dataSource.boundHierarchy,e.hierarchical=!0)}!r.dataExport.groupBy&&r.grouping.enabled&&r.dataSource&&r.dataSource.groupBy&&(e.groupBy=r.dataSource.groupBy&&r.dataSource.groupBy.toArray?r.dataSource.groupBy.toArray():null),r.checkLicense(!0),e.exportData(w,o,r.dataExport.fileName)}}]),o}());
//# sourceMappingURL=jqxgrid.export.js.map
